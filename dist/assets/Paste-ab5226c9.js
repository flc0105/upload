import{c as f,_ as k,a as b,l as y,o as j,b as L,d as l,t as R,w as A,v as T}from"./index-0ee0b2ec.js";var E={},_={get exports(){return E},set exports(s){E=s}};(function(s,n){(function(m,c){c()})(f,function(){function m(t,e){return typeof e>"u"?e={autoBom:!1}:typeof e!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\uFEFF",t],{type:t.type}):t}function c(t,e,r){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){h(o.response,e,r)},o.onerror=function(){console.error("could not download file")},o.send()}function u(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return 200<=e.status&&299>=e.status}function d(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof f=="object"&&f.global===f?f:void 0,x=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),h=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!x?function(t,e,r){var o=a.URL||a.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin===location.origin?d(i):u(i.href)?c(t,e,r):d(i,i.target="_blank")):(i.href=o.createObjectURL(t),setTimeout(function(){o.revokeObjectURL(i.href)},4e4),setTimeout(function(){d(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t!="string")navigator.msSaveOrOpenBlob(m(t,r),e);else if(u(t))c(t,e,r);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout(function(){d(o)})}}:function(t,e,r,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),typeof t=="string")return c(t,e,r);var i=t.type==="application/octet-stream",M=/constructor/i.test(a.HTMLElement)||a.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||i&&M||x)&&typeof FileReader<"u"){var v=new FileReader;v.onloadend=function(){var p=v.result;p=g?p:p.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=p:location=p,o=null},v.readAsDataURL(t)}else{var $=a.URL||a.webkitURL,w=$.createObjectURL(t);o?o.location=w:location.href=w,o=null,setTimeout(function(){$.revokeObjectURL(w)},4e4)}});a.saveAs=h.saveAs=h,s.exports=h})})(_);const B={data(){return{title:"",text:""}},methods:{get(s){this.title="",this.text="",this.$root.loading=!0,b.post("/paste/get",y.stringify({id:s})).then(n=>{n.success?(this.title=n.detail.title,this.text=n.detail.text):this.$router.push("/pastes")}).catch(n=>{this.$root.showModal("错误",n.message),this.$router.push("/pastes")}).finally(()=>{this.$root.loading=!1})},update(){if(this.text.trim().length===0){this.$root.showModal("提示","正文不能为空");return}this.$root.hasToken(()=>this.update())&&(this.$root.loading=!0,b.post("/paste/update",y.stringify({id:this.$route.params.id,text:this.text})).then(s=>{s.success?this.$root.showModal("成功","修改成功"):this.$root.showModal("失败",s.msg)}).catch(s=>{this.$root.showModal("错误",s.message)}).finally(()=>{this.$root.loading=!1}))},remove(){this.$root.hasToken(()=>this.remove())&&(this.$root.loading=!0,b.post("/paste/delete",y.stringify({id:this.$route.params.id})).then(s=>{s.success?(this.$root.showModal("成功","删除成功"),this.$router.push("/pastes")):this.$root.showModal("失败",s.msg)}).catch(s=>{this.$root.showModal("错误",s.message)}).finally(()=>{this.$root.loading=!1}))},download(){var s=new Blob([this.text],{type:"text/plain;charset=utf-8"});saveAs(s,this.$route.params.id+".txt")}},created(){this.$route.params.id&&this.get(this.$route.params.id)}},S={class:"card"},U={class:"card-body border-bottom",style:{padding:"0.781rem 1rem"}},O={class:"d-flex justify-content-between flex-wrap align-items-center"},C={class:"paste-title text-muted text-truncate mw-50"},F=l("a",{class:"btn btn-outline-primary btn-sm",id:"btnCopy","data-clipboard-target":"#textarea"},"复制",-1);function D(s,n,m,c,u,d){return j(),L("div",S,[l("div",U,[l("div",O,[l("a",{class:"link-primary",onClick:n[0]||(n[0]=a=>s.$router.push("/pastes"))},"返回"),l("div",C,R(u.title),1),l("div",null,[F,l("a",{class:"btn btn-outline-primary btn-sm ms-1",onClick:n[1]||(n[1]=a=>d.download())},"下载"),l("a",{class:"btn btn-outline-primary btn-sm ms-1",onClick:n[2]||(n[2]=a=>d.update())},"提交修改"),l("a",{class:"btn btn-outline-danger btn-sm ms-1",onClick:n[3]||(n[3]=a=>s.$root.showConfirm(()=>d.remove()))},"删除")])])]),A(l("textarea",{id:"textarea",class:"form-control border-0 min-vh-75","onUpdate:modelValue":n[4]||(n[4]=a=>u.text=a)},null,512),[[T,u.text]])])}const q=k(B,[["render",D]]);export{q as default};
