import{_ as f,a as l,l as c,o as a,c as r,w as m,v as u,b as e,F as p,r as g,t as n}from"./index-02704be0.js";const x={data(){return{pastes:[],title:"",text:""}},methods:{list(){this.$root.loading=!0,l.post("/paste/list").then(t=>{t.success?this.pastes=t.detail:this.$root.showModal("失败",t.msg)}).catch(t=>{this.$root.showModal("错误",t.message)}).finally(()=>{this.$root.loading=!1})},add(){if(this.text.trim().length===0){this.$root.showModal("提示","正文不能为空");return}this.$root.loading=!0,l.post("/paste/add",c.stringify({title:this.title.trim().length===0?"未命名":this.title,text:this.text})).then(t=>{t.success?(this.list(),this.$root.showModal("发布成功",location.protocol+"//"+location.host+"/pastes/"+t.detail.id),this.text="",this.title=""):this.$root.showModal("失败",t.msg)}).catch(t=>{this.$root.showModal("错误",t.message)}).finally(()=>{this.$root.loading=!1})},remove(t){this.$root.hasToken(()=>this.remove(t))&&(this.$root.loading=!0,l.post("/paste/delete",c.stringify({id:t})).then(o=>{o.success?(this.$root.showModal("成功","删除成功"),this.list()):this.$root.showModal("失败",o.msg)}).catch(o=>{this.$root.showModal("错误",o.message)}).finally(()=>{this.$root.loading=!1}))}},created(){this.list()}},b={class:"list-group clear-both"},_=["onClick"],$={class:"float-end"},w=["data-clipboard-text"],k=["onClick"],y={class:"text-primary text-truncate mw-75"},v={class:"text-truncate mw-75"},M={class:"text-muted mb-0"};function C(t,o,B,V,i,d){return a(),r(p,null,[m(e("input",{class:"form-control mb-2",placeholder:"标题","onUpdate:modelValue":o[0]||(o[0]=s=>i.title=s)},null,512),[[u,i.title]]),m(e("textarea",{class:"form-control mb-2",rows:"10",placeholder:"正文","onUpdate:modelValue":o[1]||(o[1]=s=>i.text=s)},null,512),[[u,i.text]]),e("button",{class:"btn btn-outline-primary float-end mb-2",onClick:o[2]||(o[2]=s=>d.add())},"发布"),e("ul",b,[(a(!0),r(p,null,g(i.pastes,s=>(a(),r("li",{class:"list-group-item list-group-item-action cursor-pointer",key:s,onClick:h=>h.target.tagName!=="A"&&t.$router.push("/pastes/"+s.id)},[e("div",$,[e("a",{class:"link-primary bi bi-clipboard",id:"btnCopy","data-clipboard-text":s.text},null,8,w),e("a",{class:"link-danger bi bi-trash ms-1",onClick:h=>t.$root.showConfirm(()=>d.remove(s.id))},null,8,k)]),e("div",null,[e("p",y,n(s.title),1),e("p",v,n(s.text),1),e("p",M,"发布于 "+n(s.time.slice(0,-3)),1)])],8,_))),128))])],64)}const F=f(x,[["render",C]]);export{F as default};
